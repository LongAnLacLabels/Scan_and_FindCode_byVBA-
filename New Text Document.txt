Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim foundCell As Range
    Dim selectedValue As Variant

    ' *** Quan trọng: BỎ DÒNG XOÁ MÀU TỔNG THỂ NÀY ĐI ***
    ' Cells.Interior.Pattern = xlNone
    ' Các hàng đã được tìm thấy và tô màu sẽ KHÔNG BỊ XOÁ MÀU khi bạn chọn ô khác.
    ' Nếu bạn muốn xoá tất cả màu sau này, bạn sẽ cần một macro riêng hoặc xoá thủ công.

    ' Chỉ thực hiện tìm kiếm và tô màu nếu ô được chọn KHÔNG nằm ở cột A (cột có chỉ số 1)
    If Target.Column <> 1 Then
        ' Kiểm tra xem ô được chọn có giá trị không (không phải ô trống)
        If Not IsEmpty(Target.Value) Then
            ' Lấy giá trị từ ô được chọn
            selectedValue = Target.Value

            ' Tìm kiếm giá trị selectedValue trong Cột A
            ' LookAt:=xlWhole đảm bảo tìm kiếm chính xác toàn bộ giá trị
            Set foundCell = Columns("A").Find(What:=selectedValue, LookIn:=xlValues, LookAt:=xlWhole)

            If Not foundCell Is Nothing Then
                ' Nếu tìm thấy, bôi vàng toàn bộ hàng đó
                With Rows(foundCell.Row).Interior
                    .Pattern = xlSolid
                    .PatternColorIndex = xlAutomatic
                    .ThemeColor = xlThemeColorAccent6
                    .TintAndShade = 0.799981688894314 ' Màu vàng nhạt
                    .PatternTintAndShade = 0
                End With

                ' Di chuyển đến ô vừa tìm thấy ở Cột A
                Application.Goto foundCell, True
            End If
        End If
    End If
End Sub